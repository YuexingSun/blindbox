webpackJsonp([55],{H59A:function(e,t,n){"use strict";function i(e){n("u+1O")}Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),o=n("QHDY"),s=n("rHil"),r=n("Dild"),d=n("VPHD"),A=(o.a,s.a,{name:"shoppingCard",components:{Radio:o.a,Group:s.a},data:function(){return{userinput:"",ejectstatus:!1,picslist:[],localIds:[],serverId:[],picArr:[],picArrList:[],id:"",choose:!0}},created:function(){this.id=this.$route.query.id},methods:{goall:function(){this.$router.push({path:"/showphoto/allworks",query:{id:this.id}})},getupload:function(){var e=this,t=this.picslist.join(","),n={id:this.id,content:this.userinput,pics:t};Object(r.m)(n).then(function(t){0===t.data.errorcode?(e.$vux.loading.hide(),e.ejectstatus=!0):e.$vux.toast.text(t.data.errormsg,"middle")}).catch(function(t){e.$vux.toast.text("请求出错！","middle")})},chooseImg:function(){var e=this;this.$wechat.chooseImage({count:5-e.picArr.length,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){e.picArr=e.picArr.concat(t.localIds),e.localIds=e.picArr,5==e.picArr.length&&(e.choose=!1)}})},submitbtn:function(){return""==this.userinput?void this.$vux.toast.text("请输入您想发表的心情","middle"):0==this.picArr.length?void this.$vux.toast.text("请选择需要发布的图片","middle"):void this.syncUpload()},syncUpload:function(){if(this.$vux.loading.show(),this.localIds.length){var e=this,t=this.localIds.pop();e.$wechat.uploadImage({localId:t,isShowProgressTips:0,success:function(t){e.serverId.push(t.serverId),e.syncUpload()}})}else this.syncSubmit()},syncSubmit:function(){if(this.serverId.length){var e=this,t=this.serverId.pop();e.handleUpload(t)}else this.getupload()},handleUpload:function(e){var t=this,n={mediaid:e};Object(d.d)(n).then(function(e){if(0!==e.data.errorcode)return t.$vux.loading.hide(),t.$vux.toast.text("图片上传失败","middle"),!1;t.picslist.push(e.data.data.filePath),t.syncSubmit()}).catch(function(e){return console.log(e),t.$vux.loading.hide(),t.$vux.toast.text("图片上传失败","middle"),!1})},handleDelImg:function(e){this.picArr.splice(e,1),this.localIds=this.picArr,this.choose=!0},previewset:function(e){var t=this;t.$wechat.previewImage({current:t.picArr[e],urls:t.picArr})}},mounted:function(){var e=this;a.a.wechat.ready(function(){a.a.wechat.checkJsApi({jsApiList:["chooseImage","previewImage","uploadImage","downloadImage","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","scanQRCode"],success:function(e){console.log(e)}});localStorage.getItem("shareid");a.a.wechat.onMenuShareTimeline({title:"晒图征集活动",link:"https://m.hecate.edifier.com/weixin/index.html?#/showphoto/allworks?id="+e.id,imgUrl:"https://m.hecate.edifier.com/weixin/static/images/sharelogo.jpg",success:function(e){}}),a.a.wechat.onMenuShareAppMessage({title:"晒图征集活动",desc:"",link:"https://m.hecate.edifier.com/weixin/index.html?#/showphoto/allworks?id="+e.id,imgUrl:"https://m.hecate.edifier.com/weixin/static/images/sharelogo.jpg",success:function(e){}})})}}),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"upload"}},[n("div",{staticClass:"main"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.userinput,expression:"userinput"}],attrs:{placeholder:"请输入您想发表的心情"},domProps:{value:e.userinput},on:{input:function(t){t.target.composing||(e.userinput=t.target.value)}}}),e._v(" "),n("div",{staticClass:"uploadlist"},[e._l(e.picArr,function(t,i){return n("div",{key:i,staticClass:"list"},[n("div",[n("img",{attrs:{src:t,width:"100%"},on:{click:function(t){e.previewset(i)}}})]),n("img",{staticClass:"close",attrs:{src:"static/images/uploadclose.png"},on:{click:function(t){e.handleDelImg(i)}}})])}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.choose,expression:"choose"}],staticClass:"list",on:{click:e.chooseImg}},[n("img",{attrs:{src:"static/images/uploadImg.png",width:"100%"}})])],2)]),e._v(" "),n("div",{staticClass:"issue",on:{click:e.submitbtn}},[e._v("发 布")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.ejectstatus,expression:"ejectstatus"}],staticClass:"eject"},[n("div",{staticClass:"ejectmain"},[n("div",{staticClass:"ejectmsg"},[e._v("发布成功!")]),e._v(" "),n("div",{staticClass:"ejectbtn",on:{click:e.goall}},[e._v("去看看")])])])])},l=[],u={render:c,staticRenderFns:l},p=u,h=n("VU/8"),m=i,f=h(A,p,!1,m,"data-v-2282f206",null);t.default=f.exports},PYFr:function(e,t,n){t=e.exports=n("FZ+f")(!0),t.push([e.i,"\n#upload[data-v-2282f206] {\n  height: 100%;\n  background: #fff;\n  overflow: auto;\n}\n#upload .main[data-v-2282f206] {\n  width: 8.666667rem;\n  margin: 0 auto;\n}\n#upload .uploadlist[data-v-2282f206] {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-flex-wrap: wrap;\n          flex-wrap: wrap;\n  margin: 1.066667rem auto .8rem auto;\n}\n#upload .uploadlist div.list[data-v-2282f206] {\n  width: 2rem;\n  position: relative;\n  margin-right: .533333rem;\n  margin-bottom: .4rem;\n}\n#upload .uploadlist div.list div[data-v-2282f206] {\n  width: 2rem;\n  height: 1.4rem;\n  overflow: hidden;\n  position: relative;\n}\n#upload .uploadlist div .close[data-v-2282f206] {\n  width: .533333rem;\n  height: .533333rem;\n  position: absolute;\n  right: -0.266667rem;\n  top: -0.266667rem;\n}\n#upload textarea[data-v-2282f206] {\n  margin-top: .8rem;\n  background: #f5f5f7;\n  border-radius: .053333rem;\n  padding: .533333rem;\n  width: 7.6rem;\n  resize: none;\n  height: 2.933333rem;\n  outline: none;\n  font-size: .426667rem;\n  color: #333333;\n}\n#upload .issue[data-v-2282f206] {\n  position: fixed;\n  width: 100%;\n  height: 1.333333rem;\n  line-height: 1.333333rem;\n  text-align: center;\n  background: #008fe2;\n  font-size: .4rem;\n  color: #ffffff;\n  left: 0;\n  bottom: 0;\n}\n#upload .eject[data-v-2282f206] {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.5);\n}\n#upload .eject .ejectmain[data-v-2282f206] {\n  width: 7.2rem;\n  margin: 4.8rem auto 0 auto;\n  background: #ffffff;\n  border-radius: 12px;\n}\n#upload .eject .ejectmain .ejectmsg[data-v-2282f206] {\n  font-size: .48rem;\n  color: #030303;\n  text-align: center;\n  padding: 1.333333rem 0;\n}\n#upload .eject .ejectmain .ejectbtn[data-v-2282f206] {\n  font-size: .48rem;\n  color: #008fe2;\n  border-top: 1px solid #ccc;\n  height: 1.173333rem;\n  line-height: 1.173333rem;\n  text-align: center;\n}\n","",{version:3,sources:["/Users/binyang/work/edifier/jing_code/waptest/src/views/showphoto/upload.vue"],names:[],mappings:";AACA;EACE,aAAa;EACb,iBAAiB;EACjB,eAAe;CAChB;AACD;EACE,mBAAmB;EACnB,eAAe;CAChB;AACD;EACE,qBAAqB;EACrB,sBAAsB;EACtB,cAAc;EACd,wBAAwB;UAChB,gBAAgB;EACxB,oCAAoC;CACrC;AACD;EACE,YAAY;EACZ,mBAAmB;EACnB,yBAAyB;EACzB,qBAAqB;CACtB;AACD;EACE,YAAY;EACZ,eAAe;EACf,iBAAiB;EACjB,mBAAmB;CACpB;AACD;EACE,kBAAkB;EAClB,mBAAmB;EACnB,mBAAmB;EACnB,oBAAoB;EACpB,kBAAkB;CACnB;AACD;EACE,kBAAkB;EAClB,oBAAoB;EACpB,0BAA0B;EAC1B,oBAAoB;EACpB,cAAc;EACd,aAAa;EACb,oBAAoB;EACpB,cAAc;EACd,sBAAsB;EACtB,eAAe;CAChB;AACD;EACE,gBAAgB;EAChB,YAAY;EACZ,oBAAoB;EACpB,yBAAyB;EACzB,mBAAmB;EACnB,oBAAoB;EACpB,iBAAiB;EACjB,eAAe;EACf,QAAQ;EACR,UAAU;CACX;AACD;EACE,YAAY;EACZ,aAAa;EACb,gBAAgB;EAChB,OAAO;EACP,QAAQ;EACR,+BAA+B;CAChC;AACD;EACE,cAAc;EACd,2BAA2B;EAC3B,oBAAoB;EACpB,oBAAoB;CACrB;AACD;EACE,kBAAkB;EAClB,eAAe;EACf,mBAAmB;EACnB,uBAAuB;CACxB;AACD;EACE,kBAAkB;EAClB,eAAe;EACf,2BAA2B;EAC3B,oBAAoB;EACpB,yBAAyB;EACzB,mBAAmB;CACpB",file:"upload.vue",sourcesContent:["\n#upload[data-v-2282f206] {\n  height: 100%;\n  background: #fff;\n  overflow: auto;\n}\n#upload .main[data-v-2282f206] {\n  width: 8.666667rem;\n  margin: 0 auto;\n}\n#upload .uploadlist[data-v-2282f206] {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-flex-wrap: wrap;\n          flex-wrap: wrap;\n  margin: 1.066667rem auto .8rem auto;\n}\n#upload .uploadlist div.list[data-v-2282f206] {\n  width: 2rem;\n  position: relative;\n  margin-right: .533333rem;\n  margin-bottom: .4rem;\n}\n#upload .uploadlist div.list div[data-v-2282f206] {\n  width: 2rem;\n  height: 1.4rem;\n  overflow: hidden;\n  position: relative;\n}\n#upload .uploadlist div .close[data-v-2282f206] {\n  width: .533333rem;\n  height: .533333rem;\n  position: absolute;\n  right: -0.266667rem;\n  top: -0.266667rem;\n}\n#upload textarea[data-v-2282f206] {\n  margin-top: .8rem;\n  background: #f5f5f7;\n  border-radius: .053333rem;\n  padding: .533333rem;\n  width: 7.6rem;\n  resize: none;\n  height: 2.933333rem;\n  outline: none;\n  font-size: .426667rem;\n  color: #333333;\n}\n#upload .issue[data-v-2282f206] {\n  position: fixed;\n  width: 100%;\n  height: 1.333333rem;\n  line-height: 1.333333rem;\n  text-align: center;\n  background: #008fe2;\n  font-size: .4rem;\n  color: #ffffff;\n  left: 0;\n  bottom: 0;\n}\n#upload .eject[data-v-2282f206] {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.5);\n}\n#upload .eject .ejectmain[data-v-2282f206] {\n  width: 7.2rem;\n  margin: 4.8rem auto 0 auto;\n  background: #ffffff;\n  border-radius: 12px;\n}\n#upload .eject .ejectmain .ejectmsg[data-v-2282f206] {\n  font-size: .48rem;\n  color: #030303;\n  text-align: center;\n  padding: 1.333333rem 0;\n}\n#upload .eject .ejectmain .ejectbtn[data-v-2282f206] {\n  font-size: .48rem;\n  color: #008fe2;\n  border-top: 1px solid #ccc;\n  height: 1.173333rem;\n  line-height: 1.173333rem;\n  text-align: center;\n}\n"],sourceRoot:""}])},"u+1O":function(e,t,n){var i=n("PYFr");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("071f5a80",i,!0,{})}});
//# sourceMappingURL=55.c6b703e4666251864eb2.js.map